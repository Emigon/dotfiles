#!/bin/bash
function article_info {
    TITLE=$(pdfinfo $1 | sed -nE "s/^Title:\s+(.+)/\1/p")
    AUTHORS=$(pdfinfo $1 | sed -nE "s/^Author:\s+(.+)/\1/p")
    if [ -n "$TITLE" ] && [ -n "$AUTHORS" ]; then
        echo "$TITLE, $AUTHORS [$1]\n"
    else
        echo "[$1]\n"
    fi
}

ARTICLES=$(for path in $(find ~dp/refs/ -iname "*.pdf"); do article_info $path; done)

SELECTED=$(echo -e $ARTICLES | head --lines=-1 | sed -E 's/^\s(.*)/\1/' | dmenu -i -l 25)

if [ -n "$SELECTED" ]; then
    zathura $(echo $SELECTED | sed -nE 's/.*\[(.*)\]/\1/p')
fi
